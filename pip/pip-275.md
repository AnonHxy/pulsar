# Background knowledge
As we can see from the doc[0] that `numWorkerThreadsForNonPersistentTopic` is a configuration to specify the number of worker threads to serve non-persistent topic.
Actually, `numWorkerThreadsForNonPersistentTopic` will specify the thread number of `BrokerService#topicOrderedExecutor`. Initially it was meant only for non-persistent topics,
but now it is used for anything that needs to be done under strict order for a topic, like processing Subscriptions even for a persistent topic:
* There is only one place invoke `topicOrderedExecutor` for non-persistent topics.[1]
* Other places will invoke `topicOrderedExecutor` for persistent-topic or persistent-dispatcher. [2][3][4][5]

# Motivation
Introduce `numWorkersTopicOrderedExecutor` to deprecate `numWorkerThreadsForNonPersistentTopic`. Because`numWorkersTopicOrderedExecutor` is a more accurate name 

### Configuration
* Introduce `numWorkersTopicOrderedExecutor`:
```
private int numWorkersTopicOrderedExecutor = Runtime.getRuntime().availableProcessors();
```
* deprecate `numWorkerThreadsForNonPersistentTopic` and change it's default value to `-1`:
```
private int numWorkerThreadsForNonPersistentTopic = -1;
```

# Backward & Forward Compatibility

* Add method `ServiceConfiguration#getNumWorkersTopicOrderedExecutor()`:
```
public int getNumWorkersTopicOrderedExecutor() {
        return numWorkerThreadsForNonPersistentTopic > 0
                ? numWorkerThreadsForNonPersistentTopic : numWorkersTopicOrderedExecutor;
    }
```
* if user doesn't set the `numWorkerThreadsForNonPersistentTopic`, the value of worker threads will keep `Runtime.getRuntime().availableProcessors()`
* If user has set the `numWorkerThreadsForNonPersistentTopic`, the value will keep what user set before.


# Links
* [0] https://github.com/apache/pulsar/blob/ac46e2e4fc48dff74233623afa3635ef5285e34d/pulsar-broker-common/src/main/java/org/apache/pulsar/broker/ServiceConfiguration.java#LL1194C16-L1194C72
* [1] https://github.com/apache/pulsar/blob/50b9a93e42e412d9f17b1637287d1a4c7c7ab148/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/ServerCnx.java#L1705-L1709
* [2] https://github.com/apache/pulsar/blob/50b9a93e42e412d9f17b1637287d1a4c7c7ab148/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentDispatcherMultipleConsumers.java#L134-L142
* [3] https://github.com/apache/pulsar/blob/50b9a93e42e412d9f17b1637287d1a4c7c7ab148/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentTopic.java#L279-L281
* [4] https://github.com/apache/pulsar/blob/50b9a93e42e412d9f17b1637287d1a4c7c7ab148/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentDispatcherSingleActiveConsumer.java#L77-L83
* [5] https://github.com/apache/pulsar/blob/50b9a93e42e412d9f17b1637287d1a4c7c7ab148/pulsar-broker/src/main/java/org/apache/pulsar/broker/service/persistent/PersistentStickyKeyDispatcherMultipleConsumers.java#L392-L396


* Mailing List discussion thread: https://lists.apache.org/thread/hx8v824v5wdoz3kn44s4t9pzgfnqkt1o
* Mailing List voting thread: